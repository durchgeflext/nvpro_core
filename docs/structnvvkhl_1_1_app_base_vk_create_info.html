<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>nvpro_core: nvvkhl::AppBaseVkCreateInfo Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">nvpro_core<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('structnvvkhl_1_1_app_base_vk_create_info.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="structnvvkhl_1_1_app_base_vk_create_info-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">nvvkhl::AppBaseVkCreateInfo Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;appbase_vk.hpp&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a9cd49ae2e5544b8ec4e09f4fdadee83d" id="r_a9cd49ae2e5544b8ec4e09f4fdadee83d"><td class="memItemLeft" align="right" valign="top"><a id="a9cd49ae2e5544b8ec4e09f4fdadee83d" name="a9cd49ae2e5544b8ec4e09f4fdadee83d"></a>
VkInstance&#160;</td><td class="memItemRight" valign="bottom"><b>instance</b> {}</td></tr>
<tr class="separator:a9cd49ae2e5544b8ec4e09f4fdadee83d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6380327f48b8aa5805f298cc847fe6a" id="r_ad6380327f48b8aa5805f298cc847fe6a"><td class="memItemLeft" align="right" valign="top"><a id="ad6380327f48b8aa5805f298cc847fe6a" name="ad6380327f48b8aa5805f298cc847fe6a"></a>
VkDevice&#160;</td><td class="memItemRight" valign="bottom"><b>device</b> {}</td></tr>
<tr class="separator:ad6380327f48b8aa5805f298cc847fe6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2a277ab1bf8b192b1fe902bbb19a5a" id="r_abc2a277ab1bf8b192b1fe902bbb19a5a"><td class="memItemLeft" align="right" valign="top"><a id="abc2a277ab1bf8b192b1fe902bbb19a5a" name="abc2a277ab1bf8b192b1fe902bbb19a5a"></a>
VkPhysicalDevice&#160;</td><td class="memItemRight" valign="bottom"><b>physicalDevice</b> {}</td></tr>
<tr class="separator:abc2a277ab1bf8b192b1fe902bbb19a5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4a9a34ac19b9a43944a79b3186a496" id="r_adf4a9a34ac19b9a43944a79b3186a496"><td class="memItemLeft" align="right" valign="top"><a id="adf4a9a34ac19b9a43944a79b3186a496" name="adf4a9a34ac19b9a43944a79b3186a496"></a>
std::vector&lt; uint32_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>queueIndices</b> {}</td></tr>
<tr class="separator:adf4a9a34ac19b9a43944a79b3186a496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e267d903d1d6991027f1bc0d2876a14" id="r_a3e267d903d1d6991027f1bc0d2876a14"><td class="memItemLeft" align="right" valign="top"><a id="a3e267d903d1d6991027f1bc0d2876a14" name="a3e267d903d1d6991027f1bc0d2876a14"></a>
VkSurfaceKHR&#160;</td><td class="memItemRight" valign="bottom"><b>surface</b> {}</td></tr>
<tr class="separator:a3e267d903d1d6991027f1bc0d2876a14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f0371bc3f3c434a63758973c473d83" id="r_a21f0371bc3f3c434a63758973c473d83"><td class="memItemLeft" align="right" valign="top"><a id="a21f0371bc3f3c434a63758973c473d83" name="a21f0371bc3f3c434a63758973c473d83"></a>
VkExtent2D&#160;</td><td class="memItemRight" valign="bottom"><b>size</b> {}</td></tr>
<tr class="separator:a21f0371bc3f3c434a63758973c473d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5a310f63a0fb442e8399d2c35f9a720" id="r_ab5a310f63a0fb442e8399d2c35f9a720"><td class="memItemLeft" align="right" valign="top"><a id="ab5a310f63a0fb442e8399d2c35f9a720" name="ab5a310f63a0fb442e8399d2c35f9a720"></a>
GLFWwindow *&#160;</td><td class="memItemRight" valign="bottom"><b>window</b> {nullptr}</td></tr>
<tr class="separator:ab5a310f63a0fb442e8399d2c35f9a720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2569aeecd4683688ca1f1ec79b97a51f" id="r_a2569aeecd4683688ca1f1ec79b97a51f"><td class="memItemLeft" align="right" valign="top"><a id="a2569aeecd4683688ca1f1ec79b97a51f" name="a2569aeecd4683688ca1f1ec79b97a51f"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>useDynamicRendering</b> {false}</td></tr>
<tr class="separator:a2569aeecd4683688ca1f1ec79b97a51f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0072d6e3ccb1881c0b1f7e334ca232d5" id="r_a0072d6e3ccb1881c0b1f7e334ca232d5"><td class="memItemLeft" align="right" valign="top"><a id="a0072d6e3ccb1881c0b1f7e334ca232d5" name="a0072d6e3ccb1881c0b1f7e334ca232d5"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>useVsync</b> {false}</td></tr>
<tr class="separator:a0072d6e3ccb1881c0b1f7e334ca232d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>@DOC_START</p>
<h1><a class="anchor" id="autotoc_md328"></a>
class nvvkhl::AppBaseVk</h1>
<p><a class="el" href="classnvvkhl_1_1_app_base_vk.html">nvvkhl::AppBaseVk</a> is used in a few samples, can serve as base class for various needs. They might differ a bit in setup and functionality, but in principle aid the setup of context and window, as well as some common event processing.</p>
<p>The <a class="el" href="classnvvkhl_1_1_app_base_vk.html">nvvkhl::AppBaseVk</a> serves as the base class for many ray tracing examples and makes use of the Vulkan C API. It does the basics for Vulkan, by holding a reference to the instance and device, but also comes with optional default setups for the render passes and the swapchain.</p>
<h2><a class="anchor" id="autotoc_md329"></a>
Usage</h2>
<p>An example will derive from this class:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>VkSample : <span class="keyword">public</span> <a class="code hl_class" href="classnvvkhl_1_1_app_base_vk.html">AppBaseVk</a> </div>
<div class="line">{</div>
<div class="line">};</div>
<div class="ttc" id="aclassnvvkhl_1_1_app_base_vk_html"><div class="ttname"><a href="classnvvkhl_1_1_app_base_vk.html">nvvkhl::AppBaseVk</a></div><div class="ttdef"><b>Definition</b> appbase_vk.hpp:260</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md330"></a>
Setup</h2>
<p>In the <code>main()</code> of an application, call <code>setup()</code> which is taking a Vulkan instance, device, physical device, and a queue family index. Setup copies the given Vulkan handles into <a class="el" href="classnvvkhl_1_1_app_base.html">AppBase</a>, and query the 0th VkQueue of the specified family, which must support graphics operations and drawing to the surface passed to createSurface. Furthermore, it is creating a VkCommandPool.</p>
<p>Prior to calling setup, if you are using the <code><a class="el" href="classnvvk_1_1_context.html">nvvk::Context</a></code> class to create and initialize Vulkan instances, you may want to create a VkSurfaceKHR from the window (glfw for example) and call <code>setGCTQueueWithPresent()</code>. This will make sure the m_queueGCT queue of <a class="el" href="classnvvk_1_1_context.html">nvvk::Context</a> can draw to the surface, and m_queueGCT.familyIndex will meet the requirements of setup().</p>
<p>Creating the swapchain for displaying. Arguments are width and height, color and depth format, and vsync on/off. Defaults will create the best format for the surface.</p>
<p>Creating framebuffers has a dependency on the renderPass and depth buffer. All those are virtual and can be overridden in a sample, but default implementation exist.</p>
<ul>
<li>createDepthBuffer: creates a 2D depth/stencil image</li>
<li>createRenderPass : creates a color/depth pass and clear both buffers.</li>
</ul>
<p>Here is the dependency order:</p>
<div class="fragment"><div class="line">vkSample.createDepthBuffer();</div>
<div class="line">vkSample.createRenderPass();</div>
<div class="line">vkSample.createFrameBuffers();</div>
</div><!-- fragment --><p> cpp</p>
<p>The nvvk::Swapchain will create n images, typically 3. With this information, <a class="el" href="classnvvkhl_1_1_app_base.html">AppBase</a> is also creating 3 VkFence, 3 VkCommandBuffer and 3 VkFrameBuffer.</p>
<h3><a class="anchor" id="autotoc_md331"></a>
Frame Buffers</h3>
<p>The created frame buffers are <em>display</em> frame buffers, made to be presented on screen. The frame buffers will be created using one of the images from swapchain, and a depth buffer. There is only one depth buffer because that resource is not used simultaneously. For example, when we clear the depth buffer, it is not done immediately, but done through a command buffer, which will be executed later.</p>
<p><b>Note</b>: the imageView(s) are part of the swapchain.</p>
<h3><a class="anchor" id="autotoc_md332"></a>
Command Buffers</h3>
<p><a class="el" href="classnvvkhl_1_1_app_base.html">AppBase</a> works with 3 <em>frame command buffers</em>. Each frame is filling a command buffer and gets submitted, one after the other. This is a design choice that can be debated, but makes it simple. I think it is still possible to submit other command buffers in a frame, but those command buffers will have to be submitted before the <em>frame</em> one. The <em>frame</em> command buffer when submitted with submitFrame, will use the current fence.</p>
<h3><a class="anchor" id="autotoc_md333"></a>
Fences</h3>
<p>There are as many fences as there are images in the swapchain. At the beginning of a frame, we call prepareFrame(). This is calling the acquire() from <a class="el" href="classnvvk_1_1_swap_chain.html">nvvk::SwapChain</a> and wait until the image is available. The very first time, the fence will not stop, but later it will wait until the submit is completed on the GPU.</p>
<h2><a class="anchor" id="autotoc_md334"></a>
ImGui</h2>
<p>If the application is using Dear <a class="el" href="namespace_im_gui.html" title="@DOC_SKIP (keyword to exclude this file from automatic README.md generation)">ImGui</a>, there are convenient functions for initializing it and setting the callbacks (glfw). The first one to call is <code>initGUI(0)</code>, where the argument is the subpass it will be using. Default is 0, but if the application creates a renderpass with multi-sampling and resolves in the second subpass, this makes it possible.</p>
<h2><a class="anchor" id="autotoc_md335"></a>
Glfw Callbacks</h2>
<p>Call <code>setupGlfwCallbacks(window)</code> to have all the window callback: key, mouse, window resizing. By default <a class="el" href="classnvvkhl_1_1_app_base.html">AppBase</a> will handle resizing of the window and will recreate the images and framebuffers. If a sample needs to be aware of the resize, it can implement <code>onResize(width, height)</code>.</p>
<p>To handle the callbacks in Imgui, call <code>ImGui_ImplGlfw_InitForVulkan(window, true)</code>, where true will handle the default <a class="el" href="namespace_im_gui.html" title="@DOC_SKIP (keyword to exclude this file from automatic README.md generation)">ImGui</a> callback .</p>
<p><b>Note</b>: All the methods are virtual and can be overloaded if they are not doing the typical setup.</p>
<div class="fragment"><div class="line"><span class="comment">// Create example</span></div>
<div class="line">VulkanSample vkSample;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Window need to be opened to get the surface on which to draw</span></div>
<div class="line"><span class="keyword">const</span> VkSurfaceKHR surface = vkSample.getVkSurface(vkctx.m_instance, window);</div>
<div class="line">vkctx.setGCTQueueWithPresent(surface);</div>
<div class="line"> </div>
<div class="line">vkSample.setup(vkctx.m_instance, vkctx.m_device, vkctx.m_physicalDevice, vkctx.m_queueGCT.familyIndex);</div>
<div class="line">vkSample.createSwapchain(surface, SAMPLE_WIDTH, SAMPLE_HEIGHT);</div>
<div class="line">vkSample.createDepthBuffer();</div>
<div class="line">vkSample.createRenderPass();</div>
<div class="line">vkSample.createFrameBuffers();</div>
<div class="line">vkSample.initGUI(0);</div>
<div class="line">vkSample.setupGlfwCallbacks(window);</div>
<div class="line"> </div>
<div class="line">ImGui_ImplGlfw_InitForVulkan(window, <span class="keyword">true</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md336"></a>
Drawing loop</h2>
<p>The drawing loop in the main() is the typicall loop you will find in glfw examples. Note that <a class="el" href="classnvvkhl_1_1_app_base.html">AppBase</a> has a convenient function to tell if the window is minimize, therefore not doing any work and contain a sleep(), so the CPU is not going crazy.</p>
<div class="fragment"><div class="line"><span class="comment">// Window system loop</span></div>
<div class="line"><span class="keywordflow">while</span>(!glfwWindowShouldClose(window))</div>
<div class="line">{</div>
<div class="line">  glfwPollEvents();</div>
<div class="line">  <span class="keywordflow">if</span>(vkSample.isMinimized())</div>
<div class="line">    <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">  vkSample.display();  <span class="comment">// infinitely drawing</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md337"></a>
Display</h2>
<p>A typical display() function will need the following:</p>
<p>Acquiring the next image: <code>prepareFrame()</code> Get the command buffer for the frame. There are n command buffers equal to the number of in-flight frames. Clearing values Start rendering pass Drawing End rendering Submitting frame to display</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> VkSample::display()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Acquire </span></div>
<div class="line">  prepareFrame();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Command buffer for current frame</span></div>
<div class="line">  <span class="keyword">auto</span>                   curFrame = getCurFrame();</div>
<div class="line">  <span class="keyword">const</span> VkCommandBuffer&amp; cmdBuf   = getCommandBuffers()[curFrame];</div>
<div class="line"> </div>
<div class="line">  VkCommandBufferBeginInfo beginInfo{VK_STRUCTURE_TYPE_COMMAND_BUFFER_BEGIN_INFO};</div>
<div class="line">  beginInfo.flags = VK_COMMAND_BUFFER_USAGE_ONE_TIME_SUBMIT_BIT;</div>
<div class="line">  vkBeginCommandBuffer(cmdBuf, &amp;beginInfo);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Clearing values</span></div>
<div class="line">  std::array&lt;VkClearValue, 2&gt; clearValues{};</div>
<div class="line">  clearValues[0].color        = {{1.f, 1.f, 1.f, 1.f}};</div>
<div class="line">  clearValues[1].depthStencil = {1.0f, 0};</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Begin rendering</span></div>
<div class="line">  VkRenderPassBeginInfo renderPassBeginInfo{VK_STRUCTURE_TYPE_RENDER_PASS_BEGIN_INFO};</div>
<div class="line">  renderPassBeginInfo.clearValueCount = 2;</div>
<div class="line">  renderPassBeginInfo.pClearValues    = clearValues.data();</div>
<div class="line">  renderPassBeginInfo.renderPass      = m_renderPass;</div>
<div class="line">  renderPassBeginInfo.framebuffer     = m_framebuffers[curFram];</div>
<div class="line">  renderPassBeginInfo.renderArea      = {{0, 0}, m_size};</div>
<div class="line">  vkCmdBeginRenderPass(cmdBuf, &amp;renderPassBeginInfo, VK_SUBPASS_CONTENTS_SECONDARY_COMMAND_BUFFERS);</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <span class="comment">// .. draw scene ...</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Draw UI</span></div>
<div class="line">  ImGui_ImplVulkan_RenderDrawData( ImGui::GetDrawData(),cmdBuff)</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// End rendering</span></div>
<div class="line">  vkCmdEndRenderPass(cmdBuf);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// End of the frame and present the one which is ready</span></div>
<div class="line">  vkEndCommandBuffer(cmdBuf);</div>
<div class="line">  submitFrame();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md338"></a>
Closing</h2>
<p>Finally, all resources can be destroyed by calling <code>destroy()</code> at the end of main().</p>
<div class="fragment"><div class="line">vkSample.destroy();</div>
</div><!-- fragment --><p>@DOC_END </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li><b>appbase_vk.hpp</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacenvvkhl.html">nvvkhl</a></li><li class="navelem"><a class="el" href="structnvvkhl_1_1_app_base_vk_create_info.html">AppBaseVkCreateInfo</a></li>
    <li class="footer">Generated on Thu Apr 3 2025 15:08:55 for nvpro_core by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
